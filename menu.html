<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js"></script>
    <title>Whites Castle</title>
  </head>
  <body onload="myScript()" style="padding-top: 5em">
    <nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand ms-5 fw-bold fs-3" href="index.html">Whites Castle</a>
        <div class="d-flex">
          <a
            href="cart.html"
            class="btn btn-outline btn-light d-block d-md-none"
            ><i class="fa-shopping-cart fa"></i
            ><span class="badge rounded-pill bg-success d-none cart-count">
              3
              <span class="visually-hidden">number of cart</span>
            </span></a
          >
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarText"
            aria-controls="navbarText"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
        <div class="collapse navbar-collapse" id="navbarText">
          <ul class="navbar-nav mb-2 mb-lg-0 ms-auto fs-5 me-5">
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarScrollingDropdown"
                role="button"
                data-bs-toggle="dropdown"
                data-bs-auto-close="outside"
                aria-expanded="false"
              >
                <i class="fa fa-shopping-cart"></i>
                <span class="badge rounded-pill bg-success d-none cart-count">
                  3
                  <span class="visually-hidden">number of cart</span>
                </span>
              </a>
              <ul
                class="dropdown-menu bg-dark dropdown-menu-dark"
                aria-labelledby="navbarScrollingDropdown"
              >
                <li class="">
                  <a class="dropdown-item text-center p-2 px-5" href="cart.html"
                    >View Cart</a
                  >
                </li>
                <li class="d-flex">
                  <a
                    class="text-decoration-none w-100 btn-success text-center p-2 px-5"
                    href="checkout.html"
                    >Checkout</a
                  ><a
                    class="text-decoration-none w-100 btn-danger text-center p-2 px-5 cursor-pointer"
                    href="#"
                    onclick="clearCart()"
                    >Clear</a
                  >
                </li>
                <li>
                  <hr class="dropdown-divider" />
                  <div class="w-100 px-3 text-end">
                    Total:
                    <span class="fs-5 fw-bold total-cart-price">0</span> PKR
                  </div>
                </li>
                <li class="p-2">
                  <ol class="list-group" style="max-height: 50vh; overflow-y: auto;" id="cart-items"></ol>
                </li>
              </ul>
            </li>

            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="menu.html">Menu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="branches.html">Branches</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="order.html">My Order</a>
            </li>
          </ul>
          <span class="navbar-text"> </span>
        </div>
      </div>
    </nav>

    <div class="main nav-scroller">
      <div class="search w-100 padding-sm right-items"">
      <!-- <input class="padding-sm w-50" type="text" name="search" id="search" placeholder="Search any item"> -->
      <div class="searchBar">
        <input
          id="searchQueryInput"
          type="text"
          name="searchQueryInput"
          placeholder="Search"
          value=""
          onkeyup="filterProducts(this.value)"
        />
        <button id="searchQuerySubmit" type="submit" name="searchQuerySubmit">
          <svg style="width: 24px; height: 24px" viewBox="0 0 24 24">
            <path
              fill="#666666"
              d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"
            />
          </svg>
        </button>
      </div>
    </div>

    <div class="container mt-2">
      <ul class="nav nav-tabs fw-bold category-list">
        <li class="nav-item">
          <a
            class="nav-link hover-secondary text-secondary active"
            aria-current="page"
            href="#All"
            >All</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-warning hover-warning px-2"
            href="#Special+Pizza"
            >Special Pizza</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-danger hover-danger px-2"
            href="#Traditional+Pizza"
            >Traditional Pizza</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-primary hover-primary px-2"
            href="#Square+Pizza"
            >Square Pizza</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-success hover-success px-2"
            href="#Appitizer"
            >Appitizer</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-success hover-success px-2"
            href="#Pasta"
            >Pasta</a
          >
        </li>
        <li class="nav-item">
          <a
            class="nav-link text-info hover-info px-2"
            href="#Beverage"
            >Beverage</a
          >
        </li>
      </ul>
    </div>

    <div class="container">
      <div
        class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-3 py-3"
        id="menu"
      >
     
      </div>
    </div>

    <div id="toast">
      <div id="img">Icon</div>
      <div id="desc">A notification message..</div>
    </div>
  </body>
  <script src="cart.js"></script>
  <script>
    "use strict";

    // const categoryIDs={
    //     "Special Pizza": 1,
    //     "Traditional Pizza": 2,
    //     "Square Pizza": 3,
    //     "Appitizer": 4,
    //     "Pasta": 5 ,
    //     "Beverage": 6,
    //     "Deals": 7
    //   }
    function myScript() {

      initializeComponents();
      //get url after #
      var category = window.location.hash;
      //get li a with window.location.hash
      console.log(document.querySelector(`a[href="${category}"]`));

      //peform click

      if (category == "" || category == "#" || category == "#All") displayMenu(menu);
      else categoryClick(document.querySelector(`a[href="${category}"]`));

      // console.log(window.location.hash)
      //get category id from category name

      // displayMenu(menu.filter(item=>{
      //     return item.CategoryName == category;
      //   }));

      loadCartItems();
    }

    window.onhashchange = function () {
      var category = window.location.hash;
      //get li a with window.location.hash
      console.log(document.querySelector(`a[href="${category}"]`));
      //peform click
      if (category == "" || category == "#")
        category= "#All";
      categoryClick(document.querySelector(`a[href="${category}"]`));
    };
    function categoryClick(categoryElement) {
      let category = categoryElement.innerText;

      let categoryList = document.querySelectorAll(".category-list>li>a");
      for (let i = 0; i < categoryList.length; i++) {
        categoryList[i].classList.remove("active");
      }

      categoryElement.classList.add("active");

      if (category == "All" || category == "") displayMenu(menu);
      else
        displayMenu(
          menu.filter((item) => {
            return item.CategoryName == category;
          })
        );
    }

    function displayMenu(menu_array) {
      var container = document.getElementById("menu");
      var str = "";
      for (let item of menu_array) {
        str +=
          '<div class="col"><div class="card border-secondary h-100 shadow rounded-3 overflow-hidden bg-white" id="Item-' +
          item.ItemID +
          '"><img class="card-img-top ratio-4x3" src="' +
          (item.ImageURL == "URL"
            ? "https://upload.wikimedia.org/wikipedia/commons/d/de/Aspect_ratio_-_3x2.svg"
            : servers.images + item.ImageURL) +
          '" alt=""><h6 class="card-header bg-white">' +
          item.Name +
          '</h6><div class="card-body h-auto py-0"><div class="w-100 text-end mt-1 card-text"><i>PKR ' +
          item.Price +
          "</i></div>";
        for (let choice of item.Choices) {
          if (!choice.Optional) {
            if (choice.Options.length > 1) {
              str +=
                '<div><select class="mb-2 w-100 p-2" id="option-' +
                item.ItemID +
                "-" +
                choice.ChoiceID +
                '">';
              for (let option of choice.Options)
                str += "<option>" + option.Name + "</option>";
              str += "</select></div>";
            }
          }
        }
        // \''+item.ItemID+'\'
        str +=
          '</div><div class="card-footer bg-white"><button class="btn-outline-dark btn-block w-100 btn" onClick="addToCart(\'' +
          item.ItemID +
          "')\">Add to Cart</button></div></div></div>";
      }
      container.innerHTML = str;
    }

    function filterProducts(value) {
      console.log(value);
      let filteredMenu = [];
      for (let item of menu) {
        if (item.Name.toLowerCase().includes(value)) {
          filteredMenu.push(item);
        } else {
          for (let choice of item.Choices) {
            if (!choice.Optional) {
              if (choice.Options.length > 1) {
                for (let option of choice.Options)
                  if (option.Name.toLowerCase().includes(value)) {
                    filteredMenu.push(item);
                    break;
                  }
              }
            }
            if (filteredMenu.includes(item)) break;
          }
        }
      }
      displayMenu(filteredMenu);
    }
  </script>
</html>
